# THIS FILE IS GENERATED!

name: ci

on:
  # push:
  #   branches: [ main ]
  pull_request:

jobs:

  # Linux

  linux-x64-ninja-gcc:
    continue-on-error: true
    runs-on: [ self-hosted, Linux, X64 ]
    name: linux-x64-ninja-gcc
    steps:
      - name: Clean
        run: rm -rf *
      - name: Clone Google Test
        uses: actions/checkout@v3
        with:
          repository: "google/googletest"
          path: 'googletest'
      - name: Clone Google Benchmark
        uses: actions/checkout@v3
        with:
          repository: "google/benchmark"
          path: 'benchmark'
      - name: Clone sin-cmake
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cmake'
          path: 'sin-cmake'
      - name: Clone sin-cpp
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cpp'
          path: 'sin-cpp'
      - name: Clone CMake
        uses: actions/checkout@v3
        with:
          repository: Kitware/CMake
          ref: 'v3.29.2'
          path: 'CMake'

      - name: CMake v3.29.2
        shell: bash
        run: |
          cd CMake
          mkdir build
          cd build
          ../bootstrap --prefix=../../_install -- -DCMAKE_USE_OPENSSL=OFF -DCMAKE_CXX_COMPILER_LAUNCHER=ccache
          make -j `nproc`
          make install

      - name: Google Test
        shell: bash
        run: |
          cd googletest
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
          cmake --build build --target install
      - name: Google Benchmark
        shell: bash
        run: |
          cd benchmark
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -DBENCHMARK_ENABLE_GTEST_TESTS=OFF \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
          cmake --build build --target install
      - name: CMake
        shell: bash
        run: |
          cd sin-cpp
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
      - name: Build & Test
        shell: bash
        run: |
          cd sin-cpp/build
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --build .
          VERBOSE=1 PATH="../_install/bin:$PATH" ctest --output-on-failure

  linux-x64-ninja-clang:
    continue-on-error: true
    runs-on: [ self-hosted, Linux, X64 ]
    name: linux-x64-ninja-clang
    steps:
      - name: Clean
        run: rm -rf *
      - name: Clone Google Test
        uses: actions/checkout@v3
        with:
          repository: "google/googletest"
          path: 'googletest'
      - name: Clone Google Benchmark
        uses: actions/checkout@v3
        with:
          repository: "google/benchmark"
          path: 'benchmark'
      - name: Clone sin-cmake
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cmake'
          path: 'sin-cmake'
      - name: Clone sin-cpp
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cpp'
          path: 'sin-cpp'
      - name: Clone CMake
        uses: actions/checkout@v3
        with:
          repository: Kitware/CMake
          ref: 'v3.29.2'
          path: 'CMake'

      - name: CMake v3.29.2
        shell: bash
        run: |
          cd CMake
          mkdir build
          cd build
          ../bootstrap --prefix=../../_install -- -DCMAKE_USE_OPENSSL=OFF -DCMAKE_CXX_COMPILER_LAUNCHER=ccache
          make -j `nproc`
          make install

      - name: Google Test
        shell: bash
        run: |
          cd googletest
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: Google Benchmark
        shell: bash
        run: |
          cd benchmark
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -DBENCHMARK_ENABLE_GTEST_TESTS=OFF \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: CMake
        shell: bash
        run: |
          cd sin-cpp
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
      - name: Build & Test
        shell: bash
        run: |
          cd sin-cpp/build
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --build .
          VERBOSE=1 PATH="../_install/bin:$PATH" ctest --output-on-failure

  linux-arm64-ninja-gcc:
    continue-on-error: true
    runs-on: [ self-hosted, Linux, ARM64 ]
    name: linux-arm64-ninja-gcc
    steps:
      - name: Clean
        run: rm -rf *
      - name: Clone Google Test
        uses: actions/checkout@v3
        with:
          repository: "google/googletest"
          path: 'googletest'
      - name: Clone Google Benchmark
        uses: actions/checkout@v3
        with:
          repository: "google/benchmark"
          path: 'benchmark'
      - name: Clone sin-cmake
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cmake'
          path: 'sin-cmake'
      - name: Clone sin-cpp
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cpp'
          path: 'sin-cpp'
      - name: Clone CMake
        uses: actions/checkout@v3
        with:
          repository: Kitware/CMake
          ref: 'v3.29.2'
          path: 'CMake'

      - name: CMake v3.29.2
        shell: bash
        run: |
          cd CMake
          mkdir build
          cd build
          ../bootstrap --prefix=../../_install -- -DCMAKE_USE_OPENSSL=OFF -DCMAKE_CXX_COMPILER_LAUNCHER=ccache
          make -j `nproc`
          make install

      - name: Google Test
        shell: bash
        run: |
          cd googletest
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
          cmake --build build --target install
      - name: Google Benchmark
        shell: bash
        run: |
          cd benchmark
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -DBENCHMARK_ENABLE_GTEST_TESTS=OFF \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
          cmake --build build --target install
      - name: CMake
        shell: bash
        run: |
          cd sin-cpp
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
      - name: Build & Test
        shell: bash
        run: |
          cd sin-cpp/build
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --build .
          VERBOSE=1 PATH="../_install/bin:$PATH" ctest --output-on-failure

  linux-arm64-ninja-clang:
    continue-on-error: true
    runs-on: [ self-hosted, Linux, ARM64 ]
    name: linux-arm64-ninja-clang
    steps:
      - name: Clean
        run: rm -rf *
      - name: Clone Google Test
        uses: actions/checkout@v3
        with:
          repository: "google/googletest"
          path: 'googletest'
      - name: Clone Google Benchmark
        uses: actions/checkout@v3
        with:
          repository: "google/benchmark"
          path: 'benchmark'
      - name: Clone sin-cmake
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cmake'
          path: 'sin-cmake'
      - name: Clone sin-cpp
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cpp'
          path: 'sin-cpp'
      - name: Clone CMake
        uses: actions/checkout@v3
        with:
          repository: Kitware/CMake
          ref: 'v3.29.2'
          path: 'CMake'

      - name: CMake v3.29.2
        shell: bash
        run: |
          cd CMake
          mkdir build
          cd build
          ../bootstrap --prefix=../../_install -- -DCMAKE_USE_OPENSSL=OFF -DCMAKE_CXX_COMPILER_LAUNCHER=ccache
          make -j `nproc`
          make install

      - name: Google Test
        shell: bash
        run: |
          cd googletest
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: Google Benchmark
        shell: bash
        run: |
          cd benchmark
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -DBENCHMARK_ENABLE_GTEST_TESTS=OFF \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: CMake
        shell: bash
        run: |
          cd sin-cpp
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
      - name: Build & Test
        shell: bash
        run: |
          cd sin-cpp/build
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --build .
          VERBOSE=1 PATH="../_install/bin:$PATH" ctest --output-on-failure

  linux-x64-make-gcc:
    continue-on-error: true
    runs-on: [ self-hosted, Linux, X64 ]
    name: linux-x64-make-gcc
    steps:
      - name: Clean
        run: rm -rf *
      - name: Clone Google Test
        uses: actions/checkout@v3
        with:
          repository: "google/googletest"
          path: 'googletest'
      - name: Clone Google Benchmark
        uses: actions/checkout@v3
        with:
          repository: "google/benchmark"
          path: 'benchmark'
      - name: Clone sin-cmake
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cmake'
          path: 'sin-cmake'
      - name: Clone sin-cpp
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cpp'
          path: 'sin-cpp'
      - name: Clone CMake
        uses: actions/checkout@v3
        with:
          repository: Kitware/CMake
          ref: 'v3.29.2'
          path: 'CMake'

      - name: CMake v3.29.2
        shell: bash
        run: |
          cd CMake
          mkdir build
          cd build
          ../bootstrap --prefix=../../_install -- -DCMAKE_USE_OPENSSL=OFF -DCMAKE_CXX_COMPILER_LAUNCHER=ccache
          make -j `nproc`
          make install

      - name: Google Test
        shell: bash
        run: |
          cd googletest
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
          cmake --build build --target install
      - name: Google Benchmark
        shell: bash
        run: |
          cd benchmark
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -DBENCHMARK_ENABLE_GTEST_TESTS=OFF \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
          cmake --build build --target install
      - name: CMake
        shell: bash
        run: |
          cd sin-cpp
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -G"Unix Makefiles" \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
      - name: Build & Test
        shell: bash
        run: |
          cd sin-cpp/build
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --build .
          VERBOSE=1 PATH="../_install/bin:$PATH" ctest --output-on-failure

  linux-x64-make-clang:
    continue-on-error: true
    runs-on: [ self-hosted, Linux, X64 ]
    name: linux-x64-make-clang
    steps:
      - name: Clean
        run: rm -rf *
      - name: Clone Google Test
        uses: actions/checkout@v3
        with:
          repository: "google/googletest"
          path: 'googletest'
      - name: Clone Google Benchmark
        uses: actions/checkout@v3
        with:
          repository: "google/benchmark"
          path: 'benchmark'
      - name: Clone sin-cmake
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cmake'
          path: 'sin-cmake'
      - name: Clone sin-cpp
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cpp'
          path: 'sin-cpp'
      - name: Clone CMake
        uses: actions/checkout@v3
        with:
          repository: Kitware/CMake
          ref: 'v3.29.2'
          path: 'CMake'

      - name: CMake v3.29.2
        shell: bash
        run: |
          cd CMake
          mkdir build
          cd build
          ../bootstrap --prefix=../../_install -- -DCMAKE_USE_OPENSSL=OFF -DCMAKE_CXX_COMPILER_LAUNCHER=ccache
          make -j `nproc`
          make install

      - name: Google Test
        shell: bash
        run: |
          cd googletest
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: Google Benchmark
        shell: bash
        run: |
          cd benchmark
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -DBENCHMARK_ENABLE_GTEST_TESTS=OFF \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: CMake
        shell: bash
        run: |
          cd sin-cpp
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -G"Unix Makefiles" \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
      - name: Build & Test
        shell: bash
        run: |
          cd sin-cpp/build
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --build .
          VERBOSE=1 PATH="../_install/bin:$PATH" ctest --output-on-failure

  linux-arm64-make-gcc:
    continue-on-error: true
    runs-on: [ self-hosted, Linux, ARM64 ]
    name: linux-arm64-make-gcc
    steps:
      - name: Clean
        run: rm -rf *
      - name: Clone Google Test
        uses: actions/checkout@v3
        with:
          repository: "google/googletest"
          path: 'googletest'
      - name: Clone Google Benchmark
        uses: actions/checkout@v3
        with:
          repository: "google/benchmark"
          path: 'benchmark'
      - name: Clone sin-cmake
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cmake'
          path: 'sin-cmake'
      - name: Clone sin-cpp
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cpp'
          path: 'sin-cpp'
      - name: Clone CMake
        uses: actions/checkout@v3
        with:
          repository: Kitware/CMake
          ref: 'v3.29.2'
          path: 'CMake'

      - name: CMake v3.29.2
        shell: bash
        run: |
          cd CMake
          mkdir build
          cd build
          ../bootstrap --prefix=../../_install -- -DCMAKE_USE_OPENSSL=OFF -DCMAKE_CXX_COMPILER_LAUNCHER=ccache
          make -j `nproc`
          make install

      - name: Google Test
        shell: bash
        run: |
          cd googletest
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
          cmake --build build --target install
      - name: Google Benchmark
        shell: bash
        run: |
          cd benchmark
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -DBENCHMARK_ENABLE_GTEST_TESTS=OFF \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
          cmake --build build --target install
      - name: CMake
        shell: bash
        run: |
          cd sin-cpp
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -G"Unix Makefiles" \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=g++ -DCMAKE_C_COMPILER=gcc
      - name: Build & Test
        shell: bash
        run: |
          cd sin-cpp/build
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --build .
          VERBOSE=1 PATH="../_install/bin:$PATH" ctest --output-on-failure

  linux-arm64-make-clang:
    continue-on-error: true
    runs-on: [ self-hosted, Linux, ARM64 ]
    name: linux-arm64-make-clang
    steps:
      - name: Clean
        run: rm -rf *
      - name: Clone Google Test
        uses: actions/checkout@v3
        with:
          repository: "google/googletest"
          path: 'googletest'
      - name: Clone Google Benchmark
        uses: actions/checkout@v3
        with:
          repository: "google/benchmark"
          path: 'benchmark'
      - name: Clone sin-cmake
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cmake'
          path: 'sin-cmake'
      - name: Clone sin-cpp
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cpp'
          path: 'sin-cpp'
      - name: Clone CMake
        uses: actions/checkout@v3
        with:
          repository: Kitware/CMake
          ref: 'v3.29.2'
          path: 'CMake'

      - name: CMake v3.29.2
        shell: bash
        run: |
          cd CMake
          mkdir build
          cd build
          ../bootstrap --prefix=../../_install -- -DCMAKE_USE_OPENSSL=OFF -DCMAKE_CXX_COMPILER_LAUNCHER=ccache
          make -j `nproc`
          make install

      - name: Google Test
        shell: bash
        run: |
          cd googletest
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: Google Benchmark
        shell: bash
        run: |
          cd benchmark
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -DBENCHMARK_ENABLE_GTEST_TESTS=OFF \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: CMake
        shell: bash
        run: |
          cd sin-cpp
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -G"Unix Makefiles" \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
      - name: Build & Test
        shell: bash
        run: |
          cd sin-cpp/build
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --build .
          VERBOSE=1 PATH="../_install/bin:$PATH" ctest --output-on-failure

  # macOS

  macos-arm64-ninja-clang:
    continue-on-error: true
    runs-on: [ self-hosted, macOS, ARM64 ]
    name: macos-arm64-ninja-clang
    steps:
      - name: Clean
        run: rm -rf *
      - name: Clone Google Test
        uses: actions/checkout@v3
        with:
          repository: "google/googletest"
          path: 'googletest'
      - name: Clone Google Benchmark
        uses: actions/checkout@v3
        with:
          repository: "google/benchmark"
          path: 'benchmark'
      - name: Clone sin-cmake
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cmake'
          path: 'sin-cmake'
      - name: Clone sin-cpp
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cpp'
          path: 'sin-cpp'
      - name: Clone CMake
        uses: actions/checkout@v3
        with:
          repository: Kitware/CMake
          ref: 'v3.29.2'
          path: 'CMake'

      - name: Google Test
        shell: bash
        run: |
          cd googletest
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: Google Benchmark
        shell: bash
        run: |
          cd benchmark
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -DBENCHMARK_ENABLE_GTEST_TESTS=OFF \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: CMake
        shell: bash
        run: |
          cd sin-cpp
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
      - name: Build & Test
        shell: bash
        run: |
          cd sin-cpp/build
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --build .
          VERBOSE=1 PATH="../_install/bin:$PATH" ctest --output-on-failure

  macos-arm64-make-clang:
    continue-on-error: true
    runs-on: [ self-hosted, macOS, ARM64 ]
    name: macos-arm64-make-clang
    steps:
      - name: Clean
        run: rm -rf *
      - name: Clone Google Test
        uses: actions/checkout@v3
        with:
          repository: "google/googletest"
          path: 'googletest'
      - name: Clone Google Benchmark
        uses: actions/checkout@v3
        with:
          repository: "google/benchmark"
          path: 'benchmark'
      - name: Clone sin-cmake
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cmake'
          path: 'sin-cmake'
      - name: Clone sin-cpp
        uses: actions/checkout@v3
        with:
          repository: 'sin-is-nsimd/sin-cpp'
          path: 'sin-cpp'
      - name: Clone CMake
        uses: actions/checkout@v3
        with:
          repository: Kitware/CMake
          ref: 'v3.29.2'
          path: 'CMake'

      - name: Google Test
        shell: bash
        run: |
          cd googletest
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: Google Benchmark
        shell: bash
        run: |
          cd benchmark
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -DBENCHMARK_ENABLE_GTEST_TESTS=OFF \
                                                -GNinja \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
          cmake --build build --target install
      - name: CMake
        shell: bash
        run: |
          cd sin-cpp
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake -B build -DCMAKE_BUILD_TYPE=Release \
                                                -G"Unix Makefiles" \
                                                -DCMAKE_INSTALL_PREFIX=../_install \
                                                -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
                                                -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_COMPILER=clang
      - name: Build & Test
        shell: bash
        run: |
          cd sin-cpp/build
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --version
          VERBOSE=1 PATH="../_install/bin:$PATH" cmake --build .
          VERBOSE=1 PATH="../_install/bin:$PATH" ctest --output-on-failure
